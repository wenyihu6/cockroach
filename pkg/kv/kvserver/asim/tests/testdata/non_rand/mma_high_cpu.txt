skip_under_ci
----

gen_cluster nodes=10 node_cpu_rate_capacity=800000
----
WARNING: node CPU capacity of â‰ˆ0.00 cores is likely accidental

# Set the rebalance mode to use the mma store rebalancer and disable the lease
# and replicate queues so that only the mma store rebalancer is moving replicas
# or leases.
setting split_queue_enabled=false
----

# This workload will be initially evenly distributed over the cluster.
gen_ranges ranges=100 min_key=0 max_key=10000
----

gen_load rate=5000 rw_ratio=0.95 min_block=100 max_block=100 request_cpu_per_access=100 raft_cpu_per_write=20 min_key=0 max_key=10000
----

# Another workload is added over the second half of the keyspace, which is initially
# only on s1-s3.
gen_ranges ranges=50 min_key=10001 max_key=20000 placement_type=skewed
----

gen_load rate=5000 rw_ratio=0.95 min_block=128 max_block=128 request_cpu_per_access=100000 raft_cpu_per_write=20000 min_key=10001 max_key=20000
----

eval duration=15m samples=1 seed=42 cfgs=(mma-only) metrics=(cpu,write_bytes_per_second,replicas,leases)
----
cpu#1: last:  [s1=53395322, s2=52570700, s3=51964226, s4=51424387, s5=51195061, s6=51283116, s7=51086201, s8=50902839, s9=51054454, s10=50655997] (stddev=806860.71, mean=51553230.30, sum=515532303)
cpu#1: thrash_pct: [s1=11%, s2=7%, s3=24%, s4=8%, s5=8%, s6=9%, s7=10%, s8=8%, s9=16%, s10=8%]  (sum=109%)
leases#1: first: [s1=37, s2=22, s3=14, s4=13, s5=11, s6=11, s7=10, s8=11, s9=10, s10=11] (stddev=8.07, mean=15.00, sum=150)
leases#1: last:  [s1=10, s2=13, s3=14, s4=18, s5=15, s6=16, s7=16, s8=16, s9=15, s10=17] (stddev=2.14, mean=15.00, sum=150)
leases#1: thrash_pct: [s1=0%, s2=0%, s3=30%, s4=0%, s5=0%, s6=0%, s7=0%, s8=0%, s9=9%, s10=0%]  (sum=39%)
replicas#1: first: [s1=80, s2=70, s3=51, s4=42, s5=37, s6=35, s7=34, s8=33, s9=34, s10=34] (stddev=16.02, mean=45.00, sum=450)
replicas#1: last:  [s1=44, s2=44, s3=44, s4=47, s5=44, s6=44, s7=45, s8=45, s9=46, s10=47] (stddev=1.18, mean=45.00, sum=450)
replicas#1: thrash_pct: [s1=0%, s2=0%, s3=0%, s4=0%, s5=0%, s6=0%, s7=0%, s8=0%, s9=0%, s10=0%]  (sum=0%)
write_bytes_per_second#1: last:  [s1=24701, s2=20702, s3=18410, s4=17246, s5=15275, s6=15254, s7=15178, s8=14438, s9=15385, s10=14409] (stddev=3165.26, mean=17099.80, sum=170998)
write_bytes_per_second#1: thrash_pct: [s1=154%, s2=113%, s3=108%, s4=77%, s5=73%, s6=58%, s7=66%, s8=36%, s9=62%, s10=62%]  (sum=809%)
artifacts[mma-only]: 50e71a420626ad28
