skip_under_ci
----

gen_cluster nodes=10 node_cpu_rate_capacity=800000
----
WARNING: node CPU capacity of â‰ˆ0.00 cores is likely accidental

# Set the rebalance mode to use the mma store rebalancer and disable the lease
# and replicate queues so that only the mma store rebalancer is moving replicas
# or leases.
setting split_queue_enabled=false
----

# This workload will be initially evenly distributed over the cluster.
gen_ranges ranges=100 min_key=0 max_key=10000
----

gen_load rate=5000 rw_ratio=0.95 min_block=100 max_block=100 request_cpu_per_access=100 raft_cpu_per_write=20 min_key=0 max_key=10000
----

# Another workload is added over the second half of the keyspace, which is initially
# only on s1-s3.
gen_ranges ranges=50 min_key=10001 max_key=20000 placement_type=skewed
----

gen_load rate=5000 rw_ratio=0.95 min_block=128 max_block=128 request_cpu_per_access=100000 raft_cpu_per_write=20000 min_key=10001 max_key=20000
----

eval duration=15m samples=1 seed=42 cfgs=(mma-only) metrics=(cpu,write_bytes_per_second,replicas,leases)
----
cpu#1: last:  [s1=84548299, s2=63591275, s3=82119483, s4=71192369, s5=50817402, s6=20681896, s7=40694926, s8=40531191, s9=30602271, s10=30541914] (stddev=21510376.90, mean=51532102.60, sum=515321026)
leases#1: first: [s1=37, s2=22, s3=14, s4=13, s5=11, s6=11, s7=10, s8=11, s9=10, s10=11] (stddev=8.07, mean=15.00, sum=150)
leases#1: last:  [s1=12, s2=15, s3=13, s4=15, s5=15, s6=19, s7=14, s8=15, s9=16, s10=16] (stddev=1.79, mean=15.00, sum=150)
replicas#1: first: [s1=80, s2=70, s3=51, s4=42, s5=37, s6=35, s7=34, s8=33, s9=34, s10=34] (stddev=16.02, mean=45.00, sum=450)
replicas#1: last:  [s1=77, s2=66, s3=51, s4=42, s5=37, s6=35, s7=35, s8=36, s9=36, s10=35] (stddev=14.27, mean=45.00, sum=450)
write_bytes_per_second#1: last:  [s1=37601, s2=30535, s3=20903, s4=15203, s5=11936, s6=10693, s7=10727, s8=11378, s9=11352, s10=10664] (stddev=9134.47, mean=17099.20, sum=170992)
artifacts[mma-only]: a7c51d53ccd75a52
