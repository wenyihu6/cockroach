skip_under_ci
----

gen_cluster nodes=10 node_cpu_rate_capacity=30000
----
WARNING: node CPU capacity of â‰ˆ0.00 cores is likely accidental

# Read only workload, which generates 100_000 request cpu nanos/s evenly over
# the first half of the keyspace, which will be on all stores initially.
gen_ranges ranges=30 min_key=1 max_key=10000 placement_type=even
----

gen_load rate=1000 rw_ratio=1.0 request_cpu_per_access=500000 min_key=1 max_key=10000
----

# Write only workload, which generates no CPU and 100_000 (x replication
# factor) write bytes per second over the second half of the keyspace, which
# are all on s1-s3 initially.
gen_ranges ranges=30 min_key=10001 max_key=20000 placement_type=skewed
----

gen_load rate=20000 rw_ratio=0 min_block=1000 max_block=1000 min_key=10001 max_key=20000
----

setting split_queue_enabled=false
----

eval duration=20m samples=1 seed=42 cfgs=(mma-only,mma-and-count) metrics=(cpu,write_bytes_per_second,replicas,leases)
----
cpu#1: last:  [s1=50164551, s2=49626604, s3=50077431, s4=49926864, s5=50015895, s6=49927457, s7=49939265, s8=50004653, s9=50066250, s10=50191786] (stddev=150960.76, mean=49994075.60, sum=499940756)
cpu#1: thrash_pct: [s1=209%, s2=317%, s3=104%, s4=331%, s5=96%, s6=212%, s7=157%, s8=338%, s9=45%, s10=222%]  (sum=2031%)
leases#1: first: [s1=19, s2=11, s3=6, s4=3, s5=3, s6=3, s7=4, s8=3, s9=4, s10=4] (stddev=4.92, mean=6.00, sum=60)
leases#1: last:  [s1=9, s2=4, s3=5, s4=7, s5=7, s6=6, s7=7, s8=4, s9=6, s10=5] (stddev=1.48, mean=6.00, sum=60)
leases#1: thrash_pct: [s1=54%, s2=88%, s3=60%, s4=86%, s5=14%, s6=50%, s7=38%, s8=72%, s9=49%, s10=107%]  (sum=618%)
replicas#1: first: [s1=39, s2=33, s3=23, s4=16, s5=13, s6=12, s7=11, s8=11, s9=11, s10=11] (stddev=9.76, mean=18.00, sum=180)
replicas#1: last:  [s1=17, s2=16, s3=19, s4=19, s5=19, s6=19, s7=17, s8=17, s9=18, s10=19] (stddev=1.10, mean=18.00, sum=180)
replicas#1: thrash_pct: [s1=125%, s2=260%, s3=131%, s4=209%, s5=39%, s6=61%, s7=104%, s8=182%, s9=54%, s10=148%]  (sum=1313%)
write_bytes_per_second#1: last:  [s1=5992942, s2=6014432, s3=5994052, s4=5992935, s5=6015601, s6=5992178, s7=5995521, s8=6013429, s9=5993233, s10=5988652] (stddev=10089.60, mean=5999297.50, sum=59992975)
write_bytes_per_second#1: thrash_pct: [s1=161%, s2=267%, s3=169%, s4=221%, s5=93%, s6=116%, s7=124%, s8=114%, s9=93%, s10=123%]  (sum=1483%)
artifacts[mma-only]: 27bf3e3f24d1a402
cpu#1: last:  [s1=49766856, s2=49962142, s3=49944178, s4=49861368, s5=49856608, s6=50176752, s7=49997572, s8=50324179, s9=50047522, s10=49969265] (stddev=154062.46, mean=49990644.20, sum=499906442)
cpu#1: thrash_pct: [s1=318%, s2=261%, s3=264%, s4=157%, s5=148%, s6=154%, s7=161%, s8=101%, s9=205%, s10=157%]  (sum=1924%)
leases#1: first: [s1=19, s2=11, s3=6, s4=3, s5=3, s6=3, s7=4, s8=3, s9=4, s10=4] (stddev=4.92, mean=6.00, sum=60)
leases#1: last:  [s1=10, s2=5, s3=3, s4=3, s5=5, s6=6, s7=8, s8=4, s9=9, s10=7] (stddev=2.32, mean=6.00, sum=60)
leases#1: thrash_pct: [s1=126%, s2=52%, s3=62%, s4=24%, s5=25%, s6=62%, s7=86%, s8=36%, s9=63%, s10=62%]  (sum=597%)
replicas#1: first: [s1=39, s2=33, s3=23, s4=16, s5=13, s6=12, s7=11, s8=11, s9=11, s10=11] (stddev=9.76, mean=18.00, sum=180)
replicas#1: last:  [s1=18, s2=18, s3=17, s4=19, s5=19, s6=18, s7=17, s8=18, s9=18, s10=18] (stddev=0.63, mean=18.00, sum=180)
replicas#1: thrash_pct: [s1=176%, s2=93%, s3=82%, s4=45%, s5=53%, s6=89%, s7=197%, s8=39%, s9=68%, s10=54%]  (sum=896%)
write_bytes_per_second#1: last:  [s1=6014996, s2=5993243, s3=6011888, s4=5988889, s5=5994900, s6=6012972, s7=5993648, s8=5996647, s9=5990770, s10=5994204] (stddev=9454.23, mean=5999215.70, sum=59992157)
write_bytes_per_second#1: thrash_pct: [s1=148%, s2=116%, s3=142%, s4=109%, s5=82%, s6=105%, s7=151%, s8=83%, s9=105%, s10=43%]  (sum=1083%)
artifacts[mma-and-count]: 9411650b130765a1
